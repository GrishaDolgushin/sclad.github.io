<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
	<meta name="theme-color" content="#009578">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="styles.css" />
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="./log.png">
	<script src="./knopk1.js"> </script>
	<script src="./knopk2.js"> </script>
	<script src="./knopk3.js"> </script>
	<script src="./knopk4.js"> </script>
	<script src="./knopk5.js"> </script>
	<script src="./pars1.js"> </script>
	<script src="./pars2.js"> </script>
	<script src="./pars3.js"> </script>
	<script src="./pars4.js"> </script>
	<script src="./pars1-1.js"> </script>
	<script src="./pars2-1.js"> </script>
	<script src="./pars3-1.js"> </script>
	<script src="./pars4-1.js"> </script>
	<script src="./poisk.js"> </script>
	<script src="./knopkpoisk.js"> </script>
  </head>
  <body>
	  
	<button class="poisk" onclick="openForm3()">
		<div> Поиск </div>
	</button>
	  
	<div class="form-popup" id="myForm2">
		<form action="#" class="form-container" id="form" method="post">
			<input type="text" id="text-to-find" value="">
			<input type="button" onclick="javascript: FindOnPage('text-to-find'); return false;" value="Искать"/>
			<input type="button" onclick="closeForm3()" value="Закрыть"/>¶
		</form>
	</div>
	<button class="open-button3" onclick="openForm1()" id='kn1'>
		<div id='el1'> </div>
	</button>

	<button class="open-button2" onclick="openForm2()" id='kn2'>
		<div id='el2'> </div>
	</button>

	<button class="priem" onclick="openForm4()" id='kn3'>Добавить палет</button>

	<button class="otgrus" onclick="openForm4()" id='kn4'>Добавить заказ</button>

	<button class="open-button id='kn2'>
		<div class="div2" id='el3'> </div>
	</button>
	  
	<button class="open-button4" id='kn5' onclick="openForm5()">
		<div id='el4'> </div>
	</button>

	<button class="open-button5" id='kn6' onclick="openForm6()">
		<div id='el5'> </div>
	</button>



<div class="yar">
<h3> Первый ярус </h3>
<hr />
<div>

	<div class="form-popup" id="myForm3">
		<form action="#" class="form-container" id="form" method="post">

			<label>Рада New верт 600 white </label>
			<input type="text" name="ba">

			<label>Рада New верт 700 white </label>
			<input type="text" name="bb">

			<label>Рада New верт 800 white </label>
			<input type="text" name="bc">

			<label>Рада New верт 600 лиственица </label>
			<input type="text" name="bd">

			<label>Рада New верт 700 лиственица </label>
			<input type="text" name="bf">

			<label>Рада New верт 800 лиственица </label>
			<input type="text" name="bg">
			
			<label>Линия 600 white </label>
			<input type="text" name="bh">

			<label>Линия 700 white </label>
			<input type="text" name="bi">

			<label>Линия 800 white </label>
			<input type="text" name="bj">

			<label>Линия 600 лиственица </label>
			<input type="text" name="bk">

			<label>Линия 700 лиственица </label>
			<input type="text" name="bl">

			<label>Линия 800 лиственица </label>
			<input type="text" name="bm">

			<button type="button" id='ay'>Добавить</button>
		</form>
		</div>


	<div class="form-popup" id="myForm1">
	    <form action="#" class="form-container" id="form" method="post">
		<div class ="tab">
			<div class="vs">
			<div id="div1">
	 			<label>Рада New верт 600 white </label>
	 			<input type="checkbox" id="gal1">
        			<input type="text" name="aa" id="myInput1">
      			</div>

      			<div id="div2">
        			<label>Рада New верт 700 white </label>
				<input type="checkbox" id="gal2">
        			<input type="text" id="myInput2" name="ab">
      			</div>

			<div id="div3">
        			<label>Рада New верт 800 white </label>
				<input type="checkbox" id="gal3">
        			<input type="text" id="myInput3" name="ac">
      			</div>

			<div id="div4">
	 			<label>Рада New верт 600 лиственица </label>
	 			<input type="checkbox" id="gal4">
        			<input type="text" name="ad" id="myInput4">
      			</div>

      			<div id="div5">
        			<label>Рада New верт 700 лиственица </label>
				<input type="checkbox" id="gal5">
        			<input type="text" id="myInput5" name="af">
      			</div>

			<div id="div6">
        			<label>Рада New верт 800 лиственица </label>
				<input type="checkbox" id="gal6">
        			<input type="text" id="myInput6" name="ag">
      			</div>

			<div id="div7">
	 			<label>Линия 600 white </label>
	 			<input type="checkbox" id="gal7">
        			<input type="text" name="ah" id="myInput7">
      			</div>

      			<div id="div8">
        			<label>Линия 700 white </label>
				<input type="checkbox" id="gal8">
        			<input type="text" id="myInput8" name="ai">
      			</div>

			<div id="div9">
        			<label>Линия 800 white </label>
				<input type="checkbox" id="gal9">
        			<input type="text" id="myInput9" name="aj">
      			</div>

			<div id="div10">
	 			<label>Линия 600 лиственица </label>
	 			<input type="checkbox" id="gal10">
        			<input type="text" name="ak" id="myInput10">
      			</div>

      			<div id="div11">
        			<label>Линия 700 лиственица </label>
				<input type="checkbox" id="gal11">
        			<input type="text" id="myInput11" name="al">
      			</div>

			<div id="div12">
        			<label>Линия 800 лиственица </label>
				<input type="checkbox" id="gal12">
        			<input type="text" id="myInput12" name="am">
      			</div>

	  		<button type="button" id="nextBtn" onclick="nextPrev(1)">Взять</button>
			</div>
	  	</div>
		<div class ="tab">
			<div class="sclad">

			<button class="open-button3" id='ax'>
				<div class="div" id='el1-1'> </div>
			</button>

			<button class="open-button2" id='bx'>
				<div class="div" id='el2-1'> </div>
			</button>

			<button class="open-button" id='cx'>
				<div class="div" id='el3-1'> </div>
			</button>

			<button class="open-button4" id='dx'>
				<div class="div" id='el4-1'> </div>
			</button>

			<button class="open-button5" id='fx'>
				<div class="div" id='el5-1'> </div>
			</button>
			</div>
		</div>
		<div>
  			<span class="step"></span>
  			<span class="step"></span>
		</div>
	    </form>
</div>


<script src="./shagi.js"> </script>

<script>
const URL_APP =   "https://script.google.com/macros/s/AKfycbwVZPBel-Y85Fb9_DA1krmsCRqITFVmjXOjI9Q6jDuE70ySxt6-9PP6Ythy8EjVLoYx6Q/exec";
const URL_APP2 =  "https://script.google.com/macros/s/AKfycbz3haJmlbiSM_uMO7g0yWu2WG6XtpSDnUJIxRSG2hIVfxY0JyjlfeFJy_MTgJlY8woimg/exec";
const URL_APP3 =  "https://script.google.com/macros/s/AKfycbz1q0F6iWnJdhzndHR46Nb6QN2r0-jI-tQhO9dOi-VKgPAUlLpoJop-suawFNoC6UzbPw/exec";
const URL_APP4 =  "https://script.google.com/macros/s/AKfycbyKusLeprNiZX5zTHKxpwxrru6jciwOMvCt7AafLatdGQByoZpEu8Zon0KTzhLdEhSvWw/exec";
const URL_APP5 =  "https://script.google.com/macros/s/AKfycbxnw3tcd_4Ku65JyI_yLcPhmwaneX8VK8i5Ro9oEGBMTFfqz8wCNT1_4fxTM6ig35NANA/exec";
const URL_APP6 =  "https://script.google.com/macros/s/AKfycbwv6RsIRaBzDSAYRiVGVlM6XTGmD7J28WpxQFEHKCpexim2JIcd9cAWEAUcP2hFFrtfqQ/exec";

	// определяем какая кнопка нажата
let q;
function knop1() { q = 1; };
function knop2() { q = 2; };
function knop3() { q = 1; };
function knop4() { q = 3; };
function knop5() { q = 4; };
function knop6() { q = 5; };
kn1.addEventListener("click", knop1)
kn2.addEventListener("click", knop2)
kn3.addEventListener("click", knop3)
kn4.addEventListener("click", knop4)
kn5.addEventListener("click", knop5)
kn6.addEventListener("click", knop6)

      // находим форму в документе
 const form = document.querySelector("#form");
// навешиваем обработчик на отправку формы
ax.addEventListener("click", async (ev) => {
	// отменяем действие по умолчанию
        ev.preventDefault();
	
        if (gal1.checked) {
		var aa = document.querySelector("[name=aa]");
		aa = aa.value.trim();
	} else
		var aa = 0;

	if (gal2.checked) {
		var ab = document.querySelector("[name=ab]");
		ab = ab.value.trim();
	} else
		var ab = 0;

	if (gal3.checked) {
		var ac = document.querySelector("[name=ac]");
		ac = ac.value.trim();
	} else
	      var ac = 0;

	if (gal4.checked) {
		var ad = document.querySelector("[name=ad]");
		ad = ad.value.trim();
	} else
		var ad = 0;

	if (gal5.checked) {
		var af = document.querySelector("[name=af]");
		af = af.value.trim();
	} else
		var af = 0;

	if (gal6.checked) {
		var ag = document.querySelector("[name=ag]");
		ag = ag.value.trim();
	} else
	      var ag = 0;

	if (gal7.checked) {
		var ah = document.querySelector("[name=ah]");
		ah = ah.value.trim();
	} else
		var ah = 0;

	if (gal8.checked) {
		var ai = document.querySelector("[name=ai]");
		ai = ai.value.trim();
	} else
		var ai = 0;

	if (gal9.checked) {
		var aj = document.querySelector("[name=aj]");
		aj = aj.value.trim();
	} else
	      var aj = 0;

	if (gal10.checked) {
		var ak = document.querySelector("[name=ak]");
		ak = ak.value.trim();
	} else
		var ak = 0;

	if (gal11.checked) {
		var al = document.querySelector("[name=al]");
		al = al.value.trim();
	} else
		var al = 0;

	if (gal12.checked) {
		var am = document.querySelector("[name=am]");
		am = am.value.trim();
	} else
	      var am = 0;

        let details = {aa, ab, ac, ad, af, ag, ah, ai, aj, ak, al, am, q,};

        // подготавливаем данные для отправки
        let formBody = [];
        for (let property in details) {
          // кодируем названия и значения параметров
          let encodedKey = encodeURIComponent(property);
          let encodedValue = encodeURIComponent(details[property]);
          formBody.push(encodedKey + "=" + encodedValue);
        }
        // склеиваем параметры в одну строку
        formBody = formBody.join("&");

        // выполняем отправку данных в Google Apps
        const result = await fetch(URL_APP, {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
          },
          mode: "cors", //<- оставим по умолчанию
          body: formBody,
        })
          .then((res) => res.json())
          .catch((err) => location.reload ());

         if( result.type === 'success' ) {
            name.value = '';
	   location.reload ();
         }
         if( result.type === 'error' ) {
           alert(`Ошибка, укуси меня пёс!( ${result.errors}`)
         }


      });

bx.addEventListener("click", async (ev) => {
	// отменяем действие по умолчанию
        ev.preventDefault();
        if (gal1.checked) {
		var aa = document.querySelector("[name=aa]");
		aa = aa.value.trim();
	} else
		var aa = 0;

	if (gal2.checked) {
		var ab = document.querySelector("[name=ab]");
		ab = ab.value.trim();
	} else
		var ab = 0;

	if (gal3.checked) {
		var ac = document.querySelector("[name=ac]");
		ac = ac.value.trim();
	} else
	      var ac = 0;

	if (gal4.checked) {
		var ad = document.querySelector("[name=ad]");
		ad = ad.value.trim();
	} else
		var ad = 0;

	if (gal5.checked) {
		var af = document.querySelector("[name=af]");
		af = af.value.trim();
	} else
		var af = 0;

	if (gal6.checked) {
		var ag = document.querySelector("[name=ag]");
		ag = ag.value.trim();
	} else
	      var ag = 0;

	if (gal7.checked) {
		var ah = document.querySelector("[name=ah]");
		ah = ah.value.trim();
	} else
		var ah = 0;

	if (gal8.checked) {
		var ai = document.querySelector("[name=ai]");
		ai = ai.value.trim();
	} else
		var ai = 0;

	if (gal9.checked) {
		var aj = document.querySelector("[name=aj]");
		aj = aj.value.trim();
	} else
	      var aj = 0;

	if (gal10.checked) {
		var ak = document.querySelector("[name=ak]");
		ak = ak.value.trim();
	} else
		var ak = 0;

	if (gal11.checked) {
		var al = document.querySelector("[name=al]");
		al = al.value.trim();
	} else
		var al = 0;

	if (gal12.checked) {
		var am = document.querySelector("[name=am]");
		am = am.value.trim();
	} else
	      var am = 0;

        let details = {aa, ab, ac, ad, af, ag, ah, ai, aj, ak, al, am, q,};

        // подготавливаем данные для отправки
        let formBody = [];
        for (let property in details) {
          // кодируем названия и значения параметров
          let encodedKey = encodeURIComponent(property);
          let encodedValue = encodeURIComponent(details[property]);
          formBody.push(encodedKey + "=" + encodedValue);
        }
        // склеиваем параметры в одну строку
        formBody = formBody.join("&");

        // выполняем отправку данных в Google Apps
        const result = await fetch(URL_APP2, {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
          },
          mode: "cors", //<- оставим по умолчанию
          body: formBody,
        })
          .then((res) => res.json())
          .catch((err) => alert(err));

         if( result.type === 'success' ) {
            name.value = '';
	   location.reload ();
         }
         if( result.type === 'error' ) {
           alert(`Ошибка, укуси меня пёс!( ${result.errors}`)
         }


      });

cx.addEventListener("click", async (ev) => {
	// отменяем действие по умолчанию
        ev.preventDefault();
        if (gal1.checked) {
		var aa = document.querySelector("[name=aa]");
		aa = aa.value.trim();
	} else
		var aa = 0;

	if (gal2.checked) {
		var ab = document.querySelector("[name=ab]");
		ab = ab.value.trim();
	} else
		var ab = 0;

	if (gal3.checked) {
		var ac = document.querySelector("[name=ac]");
		ac = ac.value.trim();
	} else
	      var ac = 0;

	if (gal4.checked) {
		var ad = document.querySelector("[name=ad]");
		ad = ad.value.trim();
	} else
		var ad = 0;

	if (gal5.checked) {
		var af = document.querySelector("[name=af]");
		af = af.value.trim();
	} else
		var af = 0;

	if (gal6.checked) {
		var ag = document.querySelector("[name=ag]");
		ag = ag.value.trim();
	} else
	      var ag = 0;

	if (gal7.checked) {
		var ah = document.querySelector("[name=ah]");
		ah = ah.value.trim();
	} else
		var ah = 0;

	if (gal8.checked) {
		var ai = document.querySelector("[name=ai]");
		ai = ai.value.trim();
	} else
		var ai = 0;

	if (gal9.checked) {
		var aj = document.querySelector("[name=aj]");
		aj = aj.value.trim();
	} else
	      var aj = 0;

	if (gal10.checked) {
		var ak = document.querySelector("[name=ak]");
		ak = ak.value.trim();
	} else
		var ak = 0;

	if (gal11.checked) {
		var al = document.querySelector("[name=al]");
		al = al.value.trim();
	} else
		var al = 0;

	if (gal12.checked) {
		var am = document.querySelector("[name=am]");
		am = am.value.trim();
	} else
	      var am = 0;

        let details = {aa, ab, ac, ad, af, ag, ah, ai, aj, ak, al, am, q,};

        // подготавливаем данные для отправки
        let formBody = [];
        for (let property in details) {
          // кодируем названия и значения параметров
          let encodedKey = encodeURIComponent(property);
          let encodedValue = encodeURIComponent(details[property]);
          formBody.push(encodedKey + "=" + encodedValue);
        }
        // склеиваем параметры в одну строку
        formBody = formBody.join("&");

        // выполняем отправку данных в Google Apps
        const result = await fetch(URL_APP4, {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
          },
          mode: "cors", //<- оставим по умолчанию
          body: formBody,
        })
          .then((res) => res.json())
          .catch((err) => alert(err));

         if( result.type === 'success' ) {
            name.value = '';
	   location.reload ();
         }
         if( result.type === 'error' ) {
           alert(`Ошибка, укуси меня пёс!( ${result.errors}`)
         }


      });

dx.addEventListener("click", async (ev) => {
	// отменяем действие по умолчанию
        ev.preventDefault();
        if (gal1.checked) {
		var aa = document.querySelector("[name=aa]");
		aa = aa.value.trim();
	} else
		var aa = 0;

	if (gal2.checked) {
		var ab = document.querySelector("[name=ab]");
		ab = ab.value.trim();
	} else
		var ab = 0;

	if (gal3.checked) {
		var ac = document.querySelector("[name=ac]");
		ac = ac.value.trim();
	} else
	      var ac = 0;

	if (gal4.checked) {
		var ad = document.querySelector("[name=ad]");
		ad = ad.value.trim();
	} else
		var ad = 0;

	if (gal5.checked) {
		var af = document.querySelector("[name=af]");
		af = af.value.trim();
	} else
		var af = 0;

	if (gal6.checked) {
		var ag = document.querySelector("[name=ag]");
		ag = ag.value.trim();
	} else
	      var ag = 0;

	if (gal7.checked) {
		var ah = document.querySelector("[name=ah]");
		ah = ah.value.trim();
	} else
		var ah = 0;

	if (gal8.checked) {
		var ai = document.querySelector("[name=ai]");
		ai = ai.value.trim();
	} else
		var ai = 0;

	if (gal9.checked) {
		var aj = document.querySelector("[name=aj]");
		aj = aj.value.trim();
	} else
	      var aj = 0;

	if (gal10.checked) {
		var ak = document.querySelector("[name=ak]");
		ak = ak.value.trim();
	} else
		var ak = 0;

	if (gal11.checked) {
		var al = document.querySelector("[name=al]");
		al = al.value.trim();
	} else
		var al = 0;

	if (gal12.checked) {
		var am = document.querySelector("[name=am]");
		am = am.value.trim();
	} else
	      var am = 0;

        let details = {aa, ab, ac, ad, af, ag, ah, ai, aj, ak, al, am, q,};
        // подготавливаем данные для отправки
        let formBody = [];
        for (let property in details) {
          // кодируем названия и значения параметров
          let encodedKey = encodeURIComponent(property);
          let encodedValue = encodeURIComponent(details[property]);
          formBody.push(encodedKey + "=" + encodedValue);
        }
        // склеиваем параметры в одну строку
        formBody = formBody.join("&");

        // выполняем отправку данных в Google Apps
        const result = await fetch(URL_APP5, {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
          },
          mode: "cors", //<- оставим по умолчанию
          body: formBody,
        })
          .then((res) => res.json())
          .catch((err) => alert(err));

         if( result.type === 'success' ) {
            name.value = '';
	   location.reload ();
         }
         if( result.type === 'error' ) {
           alert(`Ошибка, укуси меня пёс!( ${result.errors}`)
         }


      });

fx.addEventListener("click", async (ev) => {
	// отменяем действие по умолчанию
        ev.preventDefault();
        if (gal1.checked) {
		var aa = document.querySelector("[name=aa]");
		aa = aa.value.trim();
	} else
		var aa = 0;

	if (gal2.checked) {
		var ab = document.querySelector("[name=ab]");
		ab = ab.value.trim();
	} else
		var ab = 0;

	if (gal3.checked) {
		var ac = document.querySelector("[name=ac]");
		ac = ac.value.trim();
	} else
	      var ac = 0;

	if (gal4.checked) {
		var ad = document.querySelector("[name=ad]");
		ad = ad.value.trim();
	} else
		var ad = 0;

	if (gal5.checked) {
		var af = document.querySelector("[name=af]");
		af = af.value.trim();
	} else
		var af = 0;

	if (gal6.checked) {
		var ag = document.querySelector("[name=ag]");
		ag = ag.value.trim();
	} else
	      var ag = 0;

	if (gal7.checked) {
		var ah = document.querySelector("[name=ah]");
		ah = ah.value.trim();
	} else
		var ah = 0;

	if (gal8.checked) {
		var ai = document.querySelector("[name=ai]");
		ai = ai.value.trim();
	} else
		var ai = 0;

	if (gal9.checked) {
		var aj = document.querySelector("[name=aj]");
		aj = aj.value.trim();
	} else
	      var aj = 0;

	if (gal10.checked) {
		var ak = document.querySelector("[name=ak]");
		ak = ak.value.trim();
	} else
		var ak = 0;

	if (gal11.checked) {
		var al = document.querySelector("[name=al]");
		al = al.value.trim();
	} else
		var al = 0;

	if (gal12.checked) {
		var am = document.querySelector("[name=am]");
		am = am.value.trim();
	} else
	      var am = 0;

        let details = {aa, ab, ac, ad, af, ag, ah, ai, aj, ak, al, am, q,};
        // подготавливаем данные для отправки
        let formBody = [];
        for (let property in details) {
          // кодируем названия и значения параметров
          let encodedKey = encodeURIComponent(property);
          let encodedValue = encodeURIComponent(details[property]);
          formBody.push(encodedKey + "=" + encodedValue);
        }
        // склеиваем параметры в одну строку
        formBody = formBody.join("&");

        // выполняем отправку данных в Google Apps
        const result = await fetch(URL_APP6, {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
          },
          mode: "cors", //<- оставим по умолчанию
          body: formBody,
        })
          .then((res) => res.json())
          .catch((err) => alert(err));

         if( result.type === 'success' ) {
            name.value = '';
	   location.reload ();
         }
         if( result.type === 'error' ) {
           alert(`Ошибка, укуси меня пёс!( ${result.errors}`)
         }


      });
	
ay.addEventListener("click", async (ev) => {
	// отменяем действие по умолчанию
        ev.preventDefault();
	
		var ba = document.querySelector("[name=ba]");
		ba = ba.value.trim();

		var bb = document.querySelector("[name=bb]");
		bb = bb.value.trim();

		var bc = document.querySelector("[name=bc]");
		bc = bc.value.trim();

		var bd = document.querySelector("[name=bd]");
		bd = bd.value.trim();

		var bf = document.querySelector("[name=bf]");
		bf = bf.value.trim();

		var bg = document.querySelector("[name=bg]");
		bg = bg.value.trim();

		var bh = document.querySelector("[name=bh]");
		bh = bh.value.trim();

		var bi = document.querySelector("[name=bi]");
		bi = bi.value.trim();

		var bj = document.querySelector("[name=bj]");
		bj = bj.value.trim();

		var bk = document.querySelector("[name=bk]");
		bk = bk.value.trim();

		var bl = document.querySelector("[name=bl]");
		bl = bl.value.trim();

		var bm = document.querySelector("[name=bm]");
		bm = bm.value.trim();

        let details = {ba, bb, bc, bd, bf, bg, bh, bi, bj, bk, bl, bm, q};

        // подготавливаем данные для отправки
        let formBody = [];
        for (let property in details) {
          // кодируем названия и значения параметров
          let encodedKey = encodeURIComponent(property);
          let encodedValue = encodeURIComponent(details[property]);
          formBody.push(encodedKey + "=" + encodedValue);
        }
        // склеиваем параметры в одну строку
        formBody = formBody.join("&");

        // выполняем отправку данных в Google Apps
        const result = await fetch(URL_APP3, {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
          },
          mode: "cors", //<- оставим по умолчанию
          body: formBody,
        })
          .then((res) => res.json())
          .catch((err) => alert(err));

         if( result.type === 'success' ) {
            name.value = '';
	   location.reload ();
         }
         if( result.type === 'error' ) {
           alert(`Ошибка, укуси меня пёс!( ${result.errors}`)
         }


      });

</script>
  </body>
</html>
